<link rel="import" href="../../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="service-account">
    <template>
        <iron-ajax auto
                   id="accountAjax"
                   handle-as="json"
                   content-type="application/json"
                   debounce-duration="300"></iron-ajax>
    </template>
    <script>
        class ServiceAccount extends Polymer.Element {
            static get is() { return "service-account" }
            static get properties() {
                return {
                    method: {
                        type: String
                    },
                    url: {
                        type: String
                    }
                }
            }

            ready() {
                super.ready();
                this.$.accountAjax.headers = {"Authorization":"Bearer "+this._getCookie('authorization'),"Content-Type":"application/x-www-form-urlencoded","Accept":"application/json"};
            }

            /**
             * Check if user is login
             *
             * @param body
             */
            check(body) {
                this.$.accountAjax.method  = "GET";
                this.$.accountAjax.url     = "http://localhost:8081/api/check";
            }

            /**
             * Login service
             *
             * @param body
             */
            login(body) {
                this.$.accountAjax.method = "POST";
                this.$.accountAjax.url    = "http://localhost:8081/api/login";
                this.$.accountAjax.body   = body;
            }

            /**
             * Resister service
             *
             * @param body
             */
            resister(body) {
                this.$.accountAjax.method = "POST";
                this.$.accountAjax.url    = "http://localhost:8081/api/register";
                this.$.accountAjax.body   = body;
            }

            /**
             * Account status service
             *
             * @param params
             */
            status(params) {
                this.$.accountAjax.method = "GET";
                this.$.accountAjax.url    = "http://localhost:8081/api/status";
                this.$.accountAjax.params = params;
            }

            /**
             * Logout service
             *
             * @param headers
             */
            logout(headers) {
                this.$.accountAjax.method  = "POST";
                this.$.accountAjax.url     = "http://localhost:8081/api/logout";
            }

            _getCookie(name) {
                var cookie = document.cookie.match('(^|[^;]+)\\s*' + name + '\\s*=\\s*([^;]+)');
                return cookie ? cookie.pop() : '';
            }
        }
        customElements.define(ServiceAccount.is, ServiceAccount);
    </script>
</dom-module>